<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>fov-chennai-water</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <div class="chart">

    </div>
    <div class="formhandler">
    </div>
  </div>

  <script src="ui/jquery/dist/jquery.min.js"></script>
  <script src="ui/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="ui/d3/build/d3.min.js"></script>
  <script src="ui/lodash/lodash.min.js"></script>
  <script src="ui/morphdom/dist/morphdom-umd.min.js"></script>
  <script src="ui/g1/dist/g1.min.js"></script>
  <script src="ui/topojson/dist/topojson.min.js"></script>
  <script src="ui/leaflet/dist/leaflet.js"></script>
  <script src="ui/vega/build/vega-core.min.js"></script>
  <script src="ui/vega-embed/build/vega-embed.min.js"></script>
  <script>

    function renderFormhandler() {
      var hash = window.location.hash.replace(/#/, '')
      $.get('rainfall.vg.json').done(function(spec) {

        spec['data'][0].url = spec['data'][0].url + hash
        vegaEmbed('.chart', spec, {
          defaultStyle: true,
          renderer: 'canvas',
          runAsync: true,
          "actions" : {
            "source": false,
            "compiled": false,
            // "editor": false
          } 
        })
        .catch(console.error)  // eslint-disable-line no-console
      })
    }

    renderFormhandler()
    $(window).on('hashchange', renderFormhandler)

    $('.formhandler').formhandler({
      src: 'data',
      filters: true,
      pageSize: 10
    })
    
  </script>
</body>

</html>
